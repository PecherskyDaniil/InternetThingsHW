# Оглавление
1. [Описание](#Описание)
2. [Задание про светофор](#Светофор)
3. [Задание про фоторезистор и направление](#Детектор-источника-света)
4. [Задание про фоторезистор и светодиод на разных микроконтроллерах](#LedPhotoDistributedSerial)
5. [Задание про использование MQTT](#MQTT)


# Описание
Данный репозиторий содержит скетчи из моей домашней работы. В Readme.md будут описываться суть работы, схема подключения и другая информация, относящаяся к домашним работам.

# Светофор
### Суть работы
> Подключить три светодиода, красный, зеленый и желтый. Если нет желтого светодиода, синий выполняет роль желтого сигнала светофора.
> Запрограммировать автоматический режим работы светофора: зеленый (10 с) - мигающий зеленый (2 с) - желтый (1с) - красный (7 с) - желтый (1с) - зеленый (10 с).
>  Добавить возможность перевода на ручное управление через команду с ПК: запрос на перевод (одна команда) и режим в котором светофор будет работать зеленый или красный (вторая команда).
> Если текущий режим не соответствует запрошенному, сделать перевод в него через желтый (3с).
>  Ограничить ручной режим на 60 секунд - далее происходит возврат к автоматическому режиму даже если запроса на возврат не было.
> В коде не должно быть задержек (delay).
### Схема подключения
![image](https://github.com/user-attachments/assets/d7476739-acb2-488b-917d-2ab8034936c7)

### Скетч
Скетч для прошивки микроконтроллера Arduino лежит в папке traffic_light репозитория. Для запуска ручного управления нужно написать 'm' в Serial. Для переключения между красным и зеленым нужно отправлять сообщения 'r' и 'g' соответственно.

### Видео демонстрация
Видео демонстрации доступно по ссылке ниже:\
https://disk.yandex.ru/i/X6cswIxhiJo6qw
# Детектор источника света
### Суть работы
>Детектор направления источника освещенности, например окна.
>Создайте схему  на макетной плате с одним или несколькими датчиками освещенности (два резистора) и двумя индикаторами (светодиод и резистор).
>Датчики и индикаторы  подключены независимо - изъятие любого из них не ведет к изменению работы остальных.
>Индикаторы показывают направление в которым нужно повернуть макетную плату вокруг своей оси.
>Должен мигать тот светодиод, при повороте в его сторону источник света должен стать ближе к направлению в котором мы смотрим, если смотреть вперед.
>При нахождении оптимального направления светодиоды, должны светиться без мигания. Не использовать delay.
### Схема подключения
![image](https://github.com/user-attachments/assets/f5395619-4365-495f-a964-689674c60e8f)

### Скетч
Скетч для прошивки микроконтроллера Arduino лежит в папке light_detector репозитория

### Видео демонстрация
Видео демонстрации работы скетча и схемы доступно по ссылке:\
https://disk.yandex.ru/i/MjievQNJMNe0FA
# LedPhotoDistributedSerial
### Суть работы
>Создать программу управляющую светодиодом (освещением) на основе показаний датчика освещенности.
>Датчик и светодиод подключены к разным микроконтроллерам.
>Микроконтроллеры не связаны между собой напрямую, только с помощью USB через ПК.
>Микроконтроллеры просто отрабатывают команды присланные с ПК, решение принимается на ПК.
### Схема подключения
![image](https://github.com/user-attachments/assets/ce04e46d-e61f-4297-8a39-5ae488f52545)
### Скетч
Скетч для прошивки микроконтроллера отвечающего за мигание светодиода лежит в папке LedPhotoDistributedSerial/led_change.
Скетч для прошивки микроконтроллера отвечающего за передачу данных с фоторезистора лежит в папке LedPhotoDistributedSerial/photo_val.
Скетч для отправки команд в Serial лежит в папке LedPhotoDistributedSerial.

### Видео демонстрация
Видео демонстрации работы скетча и схемы доступно по ссылке:\
https://disk.yandex.ru/i/bKdXRWkYG_4Ryg

# MQTT
### Суть работы
>Подключить плату с фоторезистором к одному компьютеру, а плату со светодиодом - к другому.
>Написать скрипт на Python который берёт значения фоторезистора используя библиотеку Serial и обрабатывает их и отправляет на топики с помощью библиотеки paho-mqtt. 
>Написать скрипт на Python который, слушая топики MQTT, получает значения фоторезистора и отправляет команды по включению/выключению светодиода с помощбю библиотеки Serial.
>Светодиод должен светиться только на участках убывающей яркости.


Список топиков:
* lab/UNIQUE_ID/photo/instant - значения фоторезистора в диапазоне от 0 да 100
* lab/UNIQUE_ID/photo/averge - бегущее среднее по 100 значениям фоторезистора
* lab/UNIQUE_ID/photo/stream - сырые значения фоторезистора
* lab/UNIQUE_ID/photo/activate_stream - запуск/выключение отправки значений в поток по командам "on"/"off"
* lab/UNIQUE_ID/photo/min - обновляющееся минимальное значение фоторезистора
* lab/UNIQUE_ID/photo/max - обновляющееся максимальное значение фоторезистора
### Схема подключения
![image](https://github.com/user-attachments/assets/ce04e46d-e61f-4297-8a39-5ae488f52545)
### Скетч
Скетч для прошивки микроконтроллера отвечающего за мигание светодиода лежит в папке LedPhotoDistributedSerial/led_change.
Скетч для прошивки микроконтроллера отвечающего за передачу данных с фоторезистора лежит в папке LedPhotoDistributedSerial/photo_val.
Скетч на стороне фоторезистора для отправки значений по MQTT лежит в папке MQTT_led_photo/photoside.py.
Скетч на стороне светодиода для обработки значений фоторезистора лежит в папке MQTT_led_photo/ledside.py.

### Видео демонстрация
Видео демонстрации работы скетча и схемы доступно по ссылке:\
https://disk.yandex.ru/i/mg7Io_f2WVdvkQ

